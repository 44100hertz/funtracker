* Architecture
** Samples
Headerless mono signed PCM

** Instruments
Command procedures that replace any part of the channel state

Example: ~[init] 3 41h 548k 6 7 8 9 g ha- [note] p a50~

Inferred meaning
| ~[init]~      | do the following on instrument load     |
| ~30 4100~     | 100 long sample at 0                    |
| ~548000~      | sample rate 48khz                       |
| ~60 7100~     | loop entire sample                      |
| ~8f~          | loop forward                            |
| ~8100~        | no volume adjustment                    |
| ~gc001 ha-01~ | patch to ramp volume down over 1 second |
|               |                                         |
| ~[note]~      | do the following on each note           |
| ~p0~          | play from start of sample               |
| ~a50~         | start at 50% mixer volume               |

** Channels
 - Channels have almost their entire state made of the params below
 - Channels store 1MB (262144) of their history in memory
 - The entire song stores that much as well

** Songs
 - Songs are primarily plaintext, readable copies of what you see onscreen
 - Up to 32^2 patterns of 999 length (base 32 names, 999 long jumps)

** Data
| Numbers are all doubles
  | decimal numbers, counting from 1
  | ~8m, 8c, .8, 8, 80, 8h, 8k~ are all possible power levels, in order
  | ~.1m~ considered valid, etc.
  | using only ~+~ or ~-~ will inc or dec the value
| Boolean values
  | ~y/t/1~ true
  | ~n/f/0~ false
  | will always normalize to ~0/1~ after entry

** Command format
~N-O / cXXXX~
 - ~N~ note letter
 - ~O~ octave
 - ~c~ param id (base32); what to modify
 - ~X~ params
   - ~n~ number
   - ~b~ bool
   - ~i~ id (base32)
   - ~[A-Z]~ special vaue

** List of Commands/Params
*** Internal
| syntax | desc                                        | default             |
|--------+---------------------------------------------+---------------------|
| ~0n~   | live output amplitude                       | set by song         |
| ~1i~   | load instrument; set and initialize         | ~{2}~ instrument    |
| ~2i~   | set instrument; set w/o initialize          | 0; nothing          |
| ~3n~   | sample offset in points                     | 0                   |
| ~4n~   | sample length                               | 0                   |
| ~5n~   | sample rate                                 | 16000               |
| ~6n~   | loop start                                  | 0; start of sample  |
| ~7n~   | loop length                                 | ~{4}~ sample length |
| ~8L~   | loop type; f=forward; p=pingpong; r=reverse | ~f~ = forward       |
| ~9n~   | volume base multiplier / 100                | 100 = 1x            |
note: ~3/4/5/6/7~ can be set to arbitrarily large/precise values in a macro.

*** Playback
| syntax | desc                                             | default     |
|--------+--------------------------------------------------+-------------|
| ~an~   | mixer volume; ratio / 800                        | 100 = 1/8   |
| ~dn~   | panning; 100=fully right                         | 0           |
| ~tn~   | tuning adjustment; 100=full note                 | 0           |
| ~pn~   | live phase in bytes; set if {4} > 0  and {5} > 0 | pitch-based |
| ~nn~   | whole note pitch; set by note column             | note column |

*** Patches
input/output fixed pairs: ~gh / jk / lm~
| syntax      | desc                                    | default              |
|-------------+-----------------------------------------+----------------------|
| ~[g/j/l]*~  | input                                   |                      |
|             | ~* = cn~ constant value n               | 1                    |
|             | ~* = [num]d~ channel num, delay d in ms | channel=0, delay=0   |
|             | ~* = ad~ the final mix, delay d in ms   | delay=0              |
|             | ~* = ln~ an LFO n ticks per loop / 16   | 16 = 1 tick per loop |
| ~[h/k/m]O*~ | output                                  |                      |
|             | ~O~ output param to modify              |                      |
|             | ~*~ modify method                       |                      |
|             | ~* = =n~ input * n/100                  | 100 = x1             |
|             | ~* = wn~ wet/dry mix;  0=dry, 100=wet   | 50, half and half    |
|             | ~* = +n~ base + input * n/{5}           | 1 = +1/{5}           |
|             | ~* = -n~ base + input * n/{5}           | 1 = -1/{5}           |

examples
| ~g.... ha-..~ | volume slide down 1/10000 per point         |                                   |   |
| ~g0... hp...~ | total phase modulation from channel 0       |                                   |   |
| ~g0... htw20~ | frequency modulation from channel 0         |                                   |   |
| ~g01k. h0w10~ | mix 1000-sample delayed channel 0 into self |                                   |   |

*** Channel Misc
| syntax | desc                                        | default |
|--------+---------------------------------------------+---------|
| ~cb~   | clipping mode for mixer, 1=limit to [-1, 1] |       0 |
| ~wn~   | sample rate at which to grab history        |   16000 |

*** Playback Control
| syntax | desc                | default            |
|--------+---------------------+--------------------|
| ~jjn~  | next row            | natural song order |
| ~jpn~  | next pattern        | natural song order |
| ~bn~   | song BPM            | 120                |
| ~vn~   | global volume / 100 | 100; 1x            |

*** Unused
~efruxy~ What could they be for?
